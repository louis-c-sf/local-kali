import{e as t}from"./p-93cac3a6.js";import{S as s}from"./p-c74b54ba.js";import{E as e}from"./p-d8454b73.js";import"./p-a3b5bd35.js";import{h as i,g as o,s as n,p as r}from"./p-4ebd2c24.js";import{d as a,A as c}from"./p-ca993e0f.js";import{c as p}from"./p-949334ec.js";import{h as l}from"./p-ee0b9025.js";import{p as d}from"./p-e6163d8c.js";import{a as y}from"./p-7462b7bd.js";class h{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const s=t.activityModel;if("If"!==s.type)return;const e=(s.properties||[]).find((t=>"Condition"==t.name))||{name:"Condition",expressions:{Literal:""},syntax:"Literal"},o=s.description,n=i(o&&o.length>0?o:e.expressions[e.syntax]||"");t.bodyDisplay=`<p>${n}</p>`}}class u{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying),t.on(e.ActivityPluginUpdated,this.onActivityUpdated),t.on(e.ActivityPluginValidating,this.onActivityValidating),t.on(e.ComponentLoadingCustomButton,this.onComponentLoadingCustomButton),t.on(e.ComponentCustomButtonClick,this.onComponentCustomButtonClick)}onActivityDisplaying(t){const e=t.activityModel;if("HttpEndpoint"!==e.type)return;const o=(e.properties||[]).find((t=>"Path"==t.name))||{name:"Path",expressions:{Literal:"",syntax:s.Literal}},n=i(o.expressions[o.syntax||s.Literal]);t.bodyDisplay=`<p>${n}</p>`}onComponentLoadingCustomButton(t){if("HttpEndpoint"===t.activityType){if("elsa-script-property"===t.component){if("Schema"!==t.prop)return;t.data={label:"Convert to Json Schema"}}"elsa-workflow-definition-editor-screen"===t.component&&(t.data={label:"Use as Schema"})}}onComponentCustomButtonClick(s){var i;if("HttpEndpoint"===s.activityType){if("elsa-script-property"===s.component){if("Schema"!==s.prop)return;window.open("https://www.convertsimple.com/convert-json-to-json-schema/")}if("elsa-workflow-definition-editor-screen"===s.component){const o={activityModel:s.params[0],data:JSON.stringify(a.convert(null===(i=s.params[1])||void 0===i?void 0:i.Body),null,1)};t.emit(e.ActivityPluginUpdated,this,o)}}}onActivityUpdated(i){const o=i.activityModel;if("HttpEndpoint"!==o.type)return;const n=(o.properties||[]).find((t=>"Schema"==t.name))||{name:"Schema",expressions:{Literal:"",syntax:s.Literal}};n.expressions[s.Literal]=i.data,t.emit(e.UpdateActivity,this,n)}onActivityValidating(t){if("HttpEndpoint"!==t.activityType||"Schema"!==t.prop)return;const s=t.value;let e=!0;if(""==s)return;const i=new c;let o;try{o=JSON.parse(s)}catch(t){e=!1}if(null!=o)try{null!=i.compile(o).errors&&(e=!1)}catch(t){e=!1}t.isValidated=!0,t.isValid=e,t.data=e?"Json is valid":"Json is invalid"}}class m{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const s=t.activityModel;if("Timer"!==s.type)return;const e=(s.properties||[]).find((t=>"Timeout"==t.name))||{name:"Timeout",expressions:{Literal:""},syntax:"Literal"},o=i(e.expressions[e.syntax]||"");t.bodyDisplay=`<p>${o}</p>`}}class f{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("WriteLine"!==e.type)return;const o=(e.properties||[]).find((t=>"Text"==t.name))||{name:"Text",expressions:{Literal:""},syntax:s.Literal};t.bodyDisplay=`<p>${i(o.expressions[o.syntax||"Literal"]||"")}</p>`}}class g{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("SendEmail"!==e.type)return;const o=(e.properties||[]).find((t=>"To"==t.name))||{expressions:{Json:""},syntax:s.Json},n=e.description,r=i(n&&n.length>0?n:o.expressions[o.syntax||s.Json]||"");t.bodyDisplay=`<p>To: ${r}</p>`}}class D{display(t,s){const e=o(t,s.name);return l("elsa-check-list-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class v{display(t,s){const e=o(t,s.name);return l("elsa-checkbox-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class x{display(t,s){const e=o(t,s.name),i=s.options||{},n=this.getEditorHeight(i);return l("elsa-script-property",{activityModel:t,propertyDescriptor:s,propertyModel:e,"editor-height":n,syntax:i.syntax})}update(t,s,e){const i=e.get(s.name);n(t,s.name,i,"Literal")}getEditorHeight(t){switch(t.editorHeight||"Default"){case"Large":return"20em";case"Default":default:return"8em"}}}class w{display(t,s){const e=o(t,s.name);return l("elsa-dropdown-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class S{display(t,s){const e=o(t,s.name);return l("elsa-json-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class M{display(t,s){const e=o(t,s.name);return l("elsa-multi-text-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class C{display(t,s){const e=o(t,s.name);return l("elsa-multi-line-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class L{display(t,s){const e=o(t,s.name);return l("elsa-radio-list-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class A{display(t,s){const e=o(t,s.name);return l("elsa-single-line-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}}class b{display(t,s){const e=o(t,s.name);return l("elsa-switch-cases-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class j{display(t,s){const e=o(t,s.name);return l("elsa-dictionary-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class E{display(t,s){const e=o(t,s.name);return l("elsa-cron-expression-property",{activityModel:t,propertyDescriptor:s,propertyModel:e})}update(t,s,e){}}class T{constructor(){this.addDriver("single-line",(()=>new A)),this.addDriver("multi-line",(()=>new C)),this.addDriver("json",(()=>new S)),this.addDriver("check-list",(()=>new D)),this.addDriver("radio-list",(()=>new L)),this.addDriver("checkbox",(()=>new v)),this.addDriver("dropdown",(()=>new w)),this.addDriver("multi-text",(()=>new M)),this.addDriver("code-editor",(()=>new x)),this.addDriver("switch-case-builder",(()=>new b)),this.addDriver("dictionary",(()=>new j)),this.addDriver("cron-expression",(()=>new E))}addDriver(t,s){d.addDriver(t,s)}}class R{constructor(){t.on(e.ActivityDescriptorDisplaying,this.onActivityDescriptorDisplaying),t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDescriptorDisplaying(t){const s=y.getIcon(t.activityDescriptor.type);s&&(t.activityIcon=s)}onActivityDesignDisplaying(t){const s=y.getIcon(t.activityModel.type);s&&(t.activityIcon=s)}}class ${constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const s=t.activityModel,e=t.activityDescriptor.inputProperties.filter((t=>"switch-case-builder"==t.uiHint));if(0==e.length)return;let i={};for(const t of e){const e=((s.properties||[]).find((s=>s.name==t.name))||{expressions:{Switch:""},syntax:"Switch"}).expressions.Switch||[],o=e.$values?e.$values:Array.isArray(e)?e:r(e)||[];for(const t of o)i[t.name]=!0}const o=Object.keys(i);t.outcomes=[...o,"Default","Done"]}}class P{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const s=t.activityModel;if("While"!==s.type)return;const e=(s.properties||[]).find((t=>"Condition"==t.name))||{name:"Condition",expressions:{Literal:""},syntax:"Literal"},o=s.description,n=i(o&&o.length>0?o:e.expressions[e.syntax]||"");t.bodyDisplay=`<p>${n}</p>`}}class H{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const s=t.activityModel;if("StartAt"!==s.type)return;const e=(s.properties||[]).find((t=>"Instant"==t.name))||{name:"Instant",expressions:{Literal:""},syntax:"Literal"},o=i(e.expressions[e.syntax]||"");t.bodyDisplay=`<p>${o}</p>`}}class N{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("Cron"!==e.type)return;const o=(e.properties||[]).find((t=>"CronExpression"==t.name))||{name:"CronExpression",expressions:{Literal:""},syntax:s.Literal},n=i(o.expressions[o.syntax||"Literal"]||""),r=p.toString(n,{throwExceptionOnParseError:!1});t.bodyDisplay=`<p style="overflow: hidden;text-overflow: ellipsis;" title="${r}">${r}</p>`}}class k{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying)}onActivityDisplaying(t){const e=t.activityModel;if("SignalReceived"!==e.type)return;const o=(e.properties||[]).find((t=>"Signal"==t.name))||{name:"Signal",expressions:{Literal:"",syntax:s.Literal}},n=i(o.expressions[o.syntax||s.Literal]);t.bodyDisplay=`<p>${n}</p>`}}class J{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying)}onActivityDisplaying(t){const e=t.activityModel;if("SendSignal"!==e.type)return;const o=(e.properties||[]).find((t=>"Signal"==t.name))||{name:"Signal",expressions:{Literal:"",syntax:s.Literal}},n=i(o.expressions[o.syntax||s.Literal]);t.bodyDisplay=`<p>${n}</p>`}}class O{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("State"!==e.type)return;const o=(e.properties||[]).find((t=>"StateName"==t.name))||{name:"Text",expressions:{Literal:""},syntax:s.Literal};t.displayName=i(o.expressions[o.syntax||"Literal"]||"State")}}class I{constructor(){this.onActivityEditorAppearing=t=>{"SendHttpRequest"==t.activityDescriptor.type&&(document.querySelector("#ReadContent").addEventListener("change",this.updateUI),document.querySelector("#ResponseContentParserName").addEventListener("change",this.updateUI),this.updateUI())},this.onActivityEditorDisappearing=t=>{"SendHttpRequest"==t.activityDescriptor.type&&(document.querySelector("#ReadContent").removeEventListener("change",this.updateUI),document.querySelector("#ResponseContentParserName").removeEventListener("change",this.updateUI))},this.updateUI=()=>{const t=document.querySelector("#ReadContent"),s=document.querySelector("#ResponseContentParserName"),e=document.querySelector("#ResponseContentParserNameControl"),i=document.querySelector("#ResponseContentTargetTypeControl"),o=s.value;e.classList.toggle("hidden",!t.checked),i.classList.toggle("hidden",!t.checked||".NET Type"!=o)},t.on(e.ActivityEditor.Appearing,this.onActivityEditorAppearing),t.on(e.ActivityEditor.Disappearing,this.onActivityEditorDisappearing)}}class q{constructor(){this.onActivityDesignDisplaying=t=>{const e=t.activityDescriptor.inputProperties.filter((t=>t.considerValuesAsOutcomes));if(e.length>0){const i=s.Json;let o=[];(t.activityModel.properties||[]).filter((t=>null!=e.find((s=>s.name==t.name)))).forEach((t=>{const s=t.expressions[i]||[],e=s.$values?s.$values:Array.isArray(s)?s:r(s)||[];o=[...o,...e]})),t.outcomes=[...o,...t.outcomes]}},t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}}class B{constructor(){this.plugins=[],this.pluginTypes=[],this.createPlugin=t=>new t(this.elsaStudio),this.pluginTypes=[T,R,h,P,$,u,I,m,H,N,k,J,f,O,g,q]}initialize(t){if(!this.initialized){this.elsaStudio=t;for(const t of this.pluginTypes)this.createPlugin(t);this.initialized=!0}}registerPlugins(t){for(const s of t)this.registerPlugin(s)}registerPlugin(t){this.pluginTypes.push(t),this.initialized&&this.createPlugin(t)}}const U=new B;export{B as P,U as p}