import{r as e,h as t}from"./p-ee0b9025.js";import{i as s}from"./p-273970f1.js";import{_ as a,t as l,a as r,b as i,d as n,i as o,e as c,f as u,g as h,h as d,j as f,k as g,l as p,m as x,n as y,o as w,p as v,q as m,r as b,s as k,u as C,v as S,w as M,x as D,y as I,z as B,A,B as T,C as W,D as j,E as F,F as z,G as L,c as R}from"./p-a3b5bd35.js";import{_ as N,a as H,i as Y,b as P,c as E,d as U,e as V,f as $,u as O,z as _}from"./p-6c6facd9.js";import{c as q}from"./p-151d0027.js";import{e as K}from"./p-93cac3a6.js";import{O as G,b as Q}from"./p-c74b54ba.js";import{E as J}from"./p-d8454b73.js";import{a as X}from"./p-4d2049bc.js";import{b as Z}from"./p-4ebd2c24.js";import"./p-ca993e0f.js";import"./p-949334ec.js";import{D as ee}from"./p-3478a766.js";import{h as te}from"./p-0265802a.js";import{l as se}from"./p-d66dbbd6.js";import{T as ae}from"./p-64c0718a.js";import"./p-1b1f9628.js";import"./p-83f217d4.js";import"./p-80de33dc.js";import"./p-3c89b68a.js";var le=Math.ceil,re=Math.max,ie=function(e,t,s,a){var l=-1,r=N,i=!0,n=e.length,o=[],c=t.length;if(!n)return o;s&&(t=u(t,h(s))),a?(r=H,i=!1):t.length>=200&&(r=f,i=!1,t=new d(t));e:for(;++l<n;){var g=e[l],p=null==s?g:s(g);if(g=a||0!==g?g:0,i&&p==p){for(var x=c;x--;)if(t[x]===p)continue e;o.push(g)}else r(t,p,a)||o.push(g)}return o},ne=g((function(e,t){return Y(e)?ie(e,n(t,1,Y,!0)):[]})),oe=g((function(e,t){var s=x(t);return Y(s)&&(s=void 0),Y(e)?ie(e,n(t,1,Y,!0),p(s)):[]})),ce=g((function(e,t){var s=x(t);return Y(s)&&(s=void 0),Y(e)?ie(e,n(t,1,Y,!0),void 0,s):[]})),ue=function(e,t,s,a){for(var l=e.length,i=a?l:-1;(a?i--:++i<l)&&t(e[i],i,e););return s?r(e,a?0:i,a?i+1:l):r(e,a?i+1:0,a?l:i)},he=function(e,t,s,a){var r=e.length;for((s=l(s))<0&&(s=-s>r?0:r+s),(a=void 0===a||a>r?r:l(a))<0&&(a+=r),a=s>a?0:function(e){return e?y(l(e),0,4294967295):0}(a);s<a;)e[s++]=t;return e},de=function(e){return e&&e.length?e[0]:void 0},fe=de,ge=Math.max,pe=Math.min,xe=function(e,t,s){for(var a=s?H:N,l=e[0].length,r=e.length,i=r,n=Array(r),o=1/0,c=[];i--;){var g=e[i];i&&t&&(g=u(g,h(t))),o=pe(g.length,o),n[i]=!s&&(t||l>=120&&g.length>=120)?new d(i&&g):void 0}g=e[0];var p=-1,x=n[0];e:for(;++p<l&&c.length<o;){var y=g[p],w=t?t(y):y;if(y=s||0!==y?y:0,!(x?f(x,w):a(c,w,s))){for(i=r;--i;){var v=n[i];if(!(v?f(v,w):a(e[i],w,s)))continue e}x&&x.push(w),c.push(y)}}return c},ye=function(e){return Y(e)?e:[]},we=g((function(e){var t=u(e,ye);return t.length&&t[0]===e[0]?xe(t):[]})),ve=g((function(e){var t=x(e),s=u(e,ye);return t===x(s)?t=void 0:s.pop(),s.length&&s[0]===e[0]?xe(s,p(t)):[]})),me=g((function(e){var t=x(e),s=u(e,ye);return(t="function"==typeof t?t:void 0)&&s.pop(),s.length&&s[0]===e[0]?xe(s,void 0,t):[]})),be=Array.prototype.join,ke=Math.max,Ce=Math.min,Se=function(e,t,s,a){for(var l=s-1,r=e.length;++l<r;)if(a(e[l],t))return l;return-1},Me=Array.prototype.splice,De=function(e,t,s,a){var l=a?Se:w,r=-1,i=t.length,n=e;for(e===t&&(t=c(t)),s&&(n=u(e,h(s)));++r<i;)for(var o=0,d=t[r],f=s?s(d):d;(o=l(n,f,o,a))>-1;)n!==e&&Me.call(n,o,1),Me.call(e,o,1);return e},Ie=function(e,t){return e&&e.length&&t&&t.length?De(e,t):e},Be=g(Ie),Ae=Array.prototype.splice,Te=function(e,t){for(var s=e?t.length:0,a=s-1;s--;){var l=t[s];if(s==a||l!==r){var r=l;b(l)?Ae.call(e,l,1):(n=S(n=l,i=e),null==(i=M(i,n))||delete i[C(x(n))])}}var i,n;return e},We=P((function(e,t){var s=null==e?0:e.length,a=function(e,t){for(var s=-1,a=t.length,l=Array(a),r=null==e;++s<a;)l[s]=r?void 0:k(e,t[s]);return l}(e,t);return Te(e,u(t,(function(e){return b(e,s)?+e:e})).sort(D)),a})),je=Array.prototype.reverse,Fe=Math.floor,ze=Math.min,Le=function(e,t,s,a){var l=0,r=null==e?0:e.length;if(0===r)return 0;for(var i=(t=s(t))!=t,n=null===t,o=I(t),c=void 0===t;l<r;){var u=Fe((l+r)/2),h=s(e[u]),d=void 0!==h,f=null===h,g=h==h,p=I(h);if(i)var x=a||g;else x=c?g&&(a||d):n?g&&d&&(a||!f):o?g&&d&&!f&&(a||!p):!f&&!p&&(a?h<=t:h<t);x?l=u+1:r=u}return ze(r,4294967294)},Re=function(e,t,s){var a=0,l=null==e?a:e.length;if("number"==typeof t&&t==t&&l<=2147483647){for(;a<l;){var r=a+l>>>1,i=e[r];null!==i&&!I(i)&&(s?i<=t:i<t)?a=r+1:l=r}return l}return Le(e,t,B,s)},Ne=function(e,t){for(var s=-1,a=e.length,l=0,r=[];++s<a;){var i=e[s],n=t?t(i):i;if(!s||!A(n,o)){var o=n;r[l++]=0===i?0:i}}return r},He=g((function(e){var t=x(e);return Y(t)&&(t=void 0),E(n(e,1,Y,!0),p(t))})),Ye=g((function(e){var t=x(e);return t="function"==typeof t?t:void 0,E(n(e,1,Y,!0),void 0,t)})),Pe=Math.max,Ee=function(e){if(!e||!e.length)return[];var t=0;return e=T(e,(function(e){if(Y(e))return t=Pe(e.length,t),!0})),W(t,(function(t){return u(e,j(t))}))},Ue=function(e,t){if(!e||!e.length)return[];var s=Ee(e);return null==t?s:u(s,(function(e){return F(t,void 0,e)}))},Ve=g((function(e,t){return Y(e)?ie(e,t):[]})),$e=function(e,t,s){var a=e.length;if(a<2)return a?E(e[0]):[];for(var l=-1,r=Array(a);++l<a;)for(var i=e[l],o=-1;++o<a;)o!=l&&(r[l]=ie(r[l]||i,e[o],t,s));return E(n(r,1),t,s)},Oe=g((function(e){return $e(T(e,Y))})),_e=g((function(e){var t=x(e);return Y(t)&&(t=void 0),$e(T(e,Y),p(t))})),qe=g((function(e){var t=x(e);return t="function"==typeof t?t:void 0,$e(T(e,Y),void 0,t)})),Ke=g(Ee),Ge=g((function(e){var t=e.length,s=t>1?e[t-1]:void 0;return s="function"==typeof s?(e.pop(),s):void 0,Ue(e,s)})),Qe={chunk:function(e,t,s){t=(s?a(e,t,s):void 0===t)?1:re(l(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var n=0,o=0,c=Array(le(i/t));n<i;)c[o++]=r(e,n,n+=t);return c},compact:function(e){for(var t=-1,s=null==e?0:e.length,a=0,l=[];++t<s;){var r=e[t];r&&(l[a++]=r)}return l},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return i(o(s)?c(s):[s],n(t,1))},difference:ne,differenceBy:oe,differenceWith:ce,drop:function(e,t,s){var a=null==e?0:e.length;return a?(t=s||void 0===t?1:l(t),r(e,t<0?0:t,a)):[]},dropRight:function(e,t,s){var a=null==e?0:e.length;return a?(t=s||void 0===t?1:l(t),r(e,0,(t=a-t)<0?0:t)):[]},dropRightWhile:function(e,t){return e&&e.length?ue(e,p(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?ue(e,p(t),!0):[]},fill:function(e,t,s,l){var r=null==e?0:e.length;return r?(s&&"number"!=typeof s&&a(e,t,s)&&(s=0,l=r),he(e,t,s,l)):[]},findIndex:z,findLastIndex:L,first:fe,flatten:$,flattenDeep:function(e){return null!=e&&e.length?n(e,1/0):[]},flattenDepth:function(e,t){return null!=e&&e.length?(t=void 0===t?1:l(t),n(e,t)):[]},fromPairs:function(e){for(var t=-1,s=null==e?0:e.length,a={};++t<s;){var l=e[t];a[l[0]]=l[1]}return a},head:de,indexOf:function(e,t,s){var a=null==e?0:e.length;if(!a)return-1;var r=null==s?0:l(s);return r<0&&(r=ge(a+r,0)),w(e,t,r)},initial:function(e){return null!=e&&e.length?r(e,0,-1):[]},intersection:we,intersectionBy:ve,intersectionWith:me,join:function(e,t){return null==e?"":be.call(e,t)},last:x,lastIndexOf:function(e,t,s){var a=null==e?0:e.length;if(!a)return-1;var r=a;return void 0!==s&&(r=(r=l(s))<0?ke(a+r,0):Ce(r,a-1)),t==t?function(e,t,s){for(var a=s+1;a--;)if(e[a]===t)return a;return a}(e,t,r):v(e,m,r,!0)},nth:function(e,t){return e&&e.length?function(e,t){var s=e.length;if(s)return b(t+=t<0?s:0,s)?e[t]:void 0}(e,l(t)):void 0},pull:Be,pullAll:Ie,pullAllBy:function(e,t,s){return e&&e.length&&t&&t.length?De(e,t,p(s)):e},pullAllWith:function(e,t,s){return e&&e.length&&t&&t.length?De(e,t,void 0,s):e},pullAt:We,remove:function(e,t){var s=[];if(!e||!e.length)return s;var a=-1,l=[],r=e.length;for(t=p(t);++a<r;){var i=e[a];t(i,a,e)&&(s.push(i),l.push(a))}return Te(e,l),s},reverse:function(e){return null==e?e:je.call(e)},slice:function(e,t,s){var i=null==e?0:e.length;return i?(s&&"number"!=typeof s&&a(e,t,s)?(t=0,s=i):(t=null==t?0:l(t),s=void 0===s?i:l(s)),r(e,t,s)):[]},sortedIndex:function(e,t){return Re(e,t)},sortedIndexBy:function(e,t,s){return Le(e,t,p(s))},sortedIndexOf:function(e,t){var s=null==e?0:e.length;if(s){var a=Re(e,t);if(a<s&&A(e[a],t))return a}return-1},sortedLastIndex:function(e,t){return Re(e,t,!0)},sortedLastIndexBy:function(e,t,s){return Le(e,t,p(s),!0)},sortedLastIndexOf:function(e,t){if(null!=e&&e.length){var s=Re(e,t,!0)-1;if(A(e[s],t))return s}return-1},sortedUniq:function(e){return e&&e.length?Ne(e):[]},sortedUniqBy:function(e,t){return e&&e.length?Ne(e,p(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?r(e,1,t):[]},take:function(e,t,s){return e&&e.length?(t=s||void 0===t?1:l(t),r(e,0,t<0?0:t)):[]},takeRight:function(e,t,s){var a=null==e?0:e.length;return a?(t=s||void 0===t?1:l(t),r(e,(t=a-t)<0?0:t,a)):[]},takeRightWhile:function(e,t){return e&&e.length?ue(e,p(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?ue(e,p(t)):[]},union:O,unionBy:He,unionWith:Ye,uniq:function(e){return e&&e.length?E(e):[]},uniqBy:function(e,t){return e&&e.length?E(e,p(t)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?E(e,void 0,t):[]},unzip:Ee,unzipWith:Ue,without:Ve,xor:Oe,xorBy:_e,xorWith:qe,zip:Ke,zipObject:_,zipObjectDeep:function(e,t){return U(e||[],t||[],V)},zipWith:Ge};const Je={en:{default:{Title:"Workflow Instances",Search:"Search",Untitled:"Untitled",Table:{Id:"ID",CorrelationId:"Correlation ID",Workflow:"Workflow",Version:"Version",InstanceName:"Instance Name",Status:"Status",Created:"Created",Finished:"Finished",LastExecuted:"Last Executed",Faulted:"Faulted",ContextMenu:{View:"View",Cancel:"Cancel",Delete:"Delete",Retry:"Retry"}},CancelDialog:{Title:"Cancel Workflow Instance",Message:"Are you sure you wish to cancel this workflow instance?"},DeleteDialog:{Title:"Delete Workflow Instance",Message:"Are you sure you wish to permanently delete this workflow instance?"},BulkCancelDialog:{Title:"Cancel Selected Workflow Instances",Message:"Are you sure you wish to cancel all selected workflow instances?"},BulkDeleteDialog:{Title:"Delete Selected Workflow Instances",Message:"Are you sure you wish to permanently delete all selected workflow instances?"},BulkRetryDialog:{Title:"Retry Selected Workflow Instances",Message:"Are you sure you wish to retry all selected workflow instances?"},Pager:{Display:"Showing {{Start}} to {{End}} of {{Results}} results"},BulkActions:{Title:"Bulk Actions",Actions:{Cancel:"Cancel",Delete:"Delete",Retry:"Retry"}},Filters:{Workflow:{Label:"Workflow",All:"All"},Status:{All:"All",Label:"Status",Running:"Running",Idle:"Idle",Suspended:"Suspended",Faulted:"Faulted",Finished:"Finished",Cancelled:"Cancelled"},Sort:{Label:"Sort",SelectedLabel:"Sort by: {{Key}}",Finished:"Finished",LastExecuted:"Last Executed",Started:"Started"},PageSize:{SelectedLabel:"Page size: {{Size}}"}}}},"zh-CN":{default:{Title:"工作流实例",Search:"搜索",Untitled:"无题",Table:{Id:"ID",CorrelationId:"相关 ID",Workflow:"工作流程",Version:"版本",InstanceName:"实例名称",Status:"状态",Created:"已创建",Finished:"已完成",LastExecuted:"最后执行",Faulted:"故障",ContextMenu:{View:"查看",Cancel:"取消",Delete:"删除"}},CancelDialog:{Title:"取消工作流实例",Message:"你确定要取消这个工作流程实例吗？"},DeleteDialog:{Title:"删除工作流实例",Message:"你确定要永久删除这个工作流程实例吗？"},BulkCancelDialog:{Title:"取消选定的工作流实例",Message:"你确定要取消所有选定的工作流程实例吗？"},BulkDeleteDialog:{Title:"删除选定的工作流实例",Message:"你确定要永久删除所有选定的工作流实例吗？"},Pager:{Display:"显示 {{Start}} 到 {{End}} 的 {{Results}} 结果"},BulkActions:{Title:"批量操作",Actions:{Cancel:"取消",Delete:"删除"}},Filters:{Workflow:{Label:"工作流程",All:"所有"},Status:{All:"所有",Label:"状态",Running:"运行中",Idle:"闲置",Suspended:"已暂停",Faulted:"故障",Finished:"已完成",Cancelled:"已取消"},Sort:{Label:"排序",SelectedLabel:"根据{{Key}}排序",Finished:"已完成",LastExecuted:"最后执行",Started:"开始"},PageSize:{SelectedLabel:"页面大小: {{Size}}"}}}},"nl-NL":{default:{}}};let Xe=class{constructor(t){e(this,t),this.orderBy=G.Started,this.workflowBlueprints=[],this.workflowInstances={items:[],page:1,pageSize:50,totalCount:0},this.selectedOrderByState=G.Started,this.selectedWorkflowInstanceIds=[],this.currentPage=0,this.currentPageSize=Xe.DEFAULT_PAGE_SIZE,this.t=(e,t)=>this.i18next.t(e,t),this.getSelectAllState=()=>{const{items:e}=this.workflowInstances;for(let t=0;t<e.length;t++)if(!this.selectedWorkflowInstanceIds.includes(e[t].id))return!1;return!0},this.setSelectAllIndeterminateState=()=>{if(this.selectAllCheckboxEl){const e=this.workflowInstances.items.filter((e=>this.selectedWorkflowInstanceIds.includes(e.id)));this.selectAllCheckboxEl.indeterminate=0!=e.length&&e.length!=this.workflowInstances.items.length}},this.onPaged=async e=>{this.currentPage=e.detail.page,await this.loadWorkflowInstances()}}connectedCallback(){this.history&&(this.unlistenRouteChanged=this.history.listen((e=>this.routeChanged(e))))}disconnectedCallback(){this.unlistenRouteChanged&&this.unlistenRouteChanged()}async componentWillLoad(){this.i18next=await se(this.culture,Je),this.selectedWorkflowId=this.workflowId,this.selectedCorrelationId=this.correlationId,this.selectedWorkflowStatus=this.workflowStatus,this.selectedOrderByState=this.orderBy,this.history&&this.applyQueryString(this.history.location.search),await this.loadWorkflowBlueprints(),await this.loadWorkflowInstances();const e=this.t;let t=[{text:e("BulkActions.Actions.Cancel"),name:"Cancel"},{text:e("BulkActions.Actions.Delete"),name:"Delete"},{text:e("BulkActions.Actions.Retry"),name:"Retry"}];await K.emit(J.WorkflowInstanceBulkActionsLoading,this,{sender:this,bulkActions:t}),this.bulkActions=t}async getSelectedWorkflowInstanceIds(){return this.selectedWorkflowInstanceIds}async refresh(){await this.loadWorkflowInstances(),this.updateSelectAllChecked()}async handleWorkflowIdChanged(e){this.selectedWorkflowId=e,await this.loadWorkflowInstances()}async handleCorrelationIdChanged(e){this.selectedCorrelationId=e,await this.loadWorkflowInstances()}async handleWorkflowStatusChanged(e){this.selectedWorkflowStatus=e,await this.loadWorkflowInstances()}async handlePageSizeChanged(e){this.currentPageSize=e,this.currentPageSize=isNaN(this.currentPageSize)?Xe.DEFAULT_PAGE_SIZE:this.currentPageSize,this.currentPageSize=Math.max(Math.min(this.currentPageSize,Xe.MAX_PAGE_SIZE),Xe.MIN_PAGE_SIZE),await this.loadWorkflowInstances()}async handleOrderByChanged(e){this.selectedOrderByState=e,await this.loadWorkflowInstances()}applyQueryString(e){var t;const s=Z(e);this.selectedWorkflowId=s.workflow,this.correlationId=s.correlationId,this.selectedWorkflowStatus=s.status,this.selectedOrderByState=null!==(t=s.orderBy)&&void 0!==t?t:G.Started,this.currentPage=s.page?parseInt(s.page):0,this.currentPage=isNaN(this.currentPage)?Xe.START_PAGE:this.currentPage,this.currentPageSize=s.pageSize?parseInt(s.pageSize):Xe.DEFAULT_PAGE_SIZE,this.currentPageSize=isNaN(this.currentPageSize)?Xe.DEFAULT_PAGE_SIZE:this.currentPageSize,this.currentPageSize=Math.max(Math.min(this.currentPageSize,Xe.MAX_PAGE_SIZE),Xe.MIN_PAGE_SIZE)}async loadWorkflowBlueprints(){const e=await this.createClient();this.workflowBlueprints=await e.workflowRegistryApi.listAll({allVersions:!0})}async loadWorkflowInstances(){this.currentPage=isNaN(this.currentPage)?Xe.START_PAGE:this.currentPage,this.currentPage=Math.max(this.currentPage,Xe.START_PAGE),this.currentPageSize=isNaN(this.currentPageSize)?Xe.DEFAULT_PAGE_SIZE:this.currentPageSize;const e=await this.createClient();this.workflowInstances=await e.workflowInstancesApi.list(this.currentPage,this.currentPageSize,this.selectedWorkflowId,this.selectedWorkflowStatus,this.selectedOrderByState,this.currentSearchTerm,this.correlationId);const t=Math.floor(this.workflowInstances.totalCount/this.currentPageSize);this.currentPage>t&&(this.currentPage=t,this.workflowInstances=await e.workflowInstancesApi.list(this.currentPage,this.currentPageSize,this.selectedWorkflowId,this.selectedWorkflowStatus,this.selectedOrderByState,this.currentSearchTerm,this.correlationId)),this.setSelectAllIndeterminateState()}createClient(){return X(this.serverUrl)}getLatestWorkflowBlueprintVersions(){const e=R.groupBy(this.workflowBlueprints,"id");return R.map(e,(e=>Qe.first(R.orderBy(e,"version","desc"))))}buildFilterUrl(e,t,s,a,l){const r={};l&&(r.correlationId=l),e&&(r.workflow=e),t&&(r.status=t),s&&(r.orderBy=s),this.currentPage&&(r.page=this.currentPage.toString());let i=a||this.currentPageSize;i=Math.max(Math.min(i,100),Xe.MIN_PAGE_SIZE),r.pageSize=i.toString(),i!=this.currentPageSize&&(r.page=Math.floor(this.currentPage*this.currentPageSize/i).toString());const n=R.map(r,((e,t)=>`${t}=${e}`)).join("&");return`${this.basePath}/workflow-instances?${n}`}getStatusColor(e){switch(e){default:case Q.Idle:return"gray";case Q.Running:return"rose";case Q.Suspended:return"blue";case Q.Finished:return"green";case Q.Faulted:return"red";case Q.Cancelled:return"yellow"}}updateSelectAllChecked(){this.selectAllChecked=0!=this.workflowInstances.items.length&&this.workflowInstances.items.findIndex((e=>this.selectedWorkflowInstanceIds.findIndex((t=>t==e.id))<0))<0}async routeChanged(e){e.pathname.toLowerCase().endsWith("workflow-instances")&&(this.applyQueryString(e.search),await this.loadWorkflowInstances())}onSelectAllCheckChange(e){const t=e.target.checked;if(this.selectAllChecked=t,t){let e=[];this.workflowInstances.items.forEach((t=>{this.selectedWorkflowInstanceIds.includes(t.id)||e.push(t.id)})),e.length>0&&(this.selectedWorkflowInstanceIds=this.selectedWorkflowInstanceIds.concat(e))}else{const e=this.workflowInstances.items.map((e=>e.id));this.selectedWorkflowInstanceIds=this.selectedWorkflowInstanceIds.filter((t=>!e.includes(t)))}}onWorkflowInstanceCheckChange(e,t){this.selectedWorkflowInstanceIds=e.target.checked?[...this.selectedWorkflowInstanceIds,t.id]:this.selectedWorkflowInstanceIds.filter((e=>e!=t.id)),this.setSelectAllIndeterminateState()}async onCancelClick(e,t){const s=this.t;if(!await q.show(s("CancelDialog.Title"),s("CancelDialog.Message")))return;const a=await this.createClient();await a.workflowInstancesApi.cancel(t.id),await this.loadWorkflowInstances()}async onDeleteClick(e,t){const s=this.t;if(!await q.show(s("DeleteDialog.Title"),s("DeleteDialog.Message")))return;const a=await this.createClient();await a.workflowInstancesApi.delete(t.id),await this.loadWorkflowInstances()}async onRetryClick(e,t){const s=this.t;if(!await q.show(s("RetryDialog.Title"),s("RetryDialog.Message")))return;const a=await this.createClient();await a.workflowInstancesApi.retry(t.id),await this.loadWorkflowInstances()}async onBulkCancel(){const e=this.t;if(!await q.show(e("BulkCancelDialog.Title"),e("BulkCancelDialog.Message")))return;const t=await this.createClient();await t.workflowInstancesApi.bulkCancel({workflowInstanceIds:this.selectedWorkflowInstanceIds}),this.selectedWorkflowInstanceIds=[],await this.loadWorkflowInstances(),this.currentPage=0}async onBulkDelete(){const e=this.t;if(!await q.show(e("BulkDeleteDialog.Title"),e("BulkDeleteDialog.Message")))return;const t=await this.createClient();await t.workflowInstancesApi.bulkDelete({workflowInstanceIds:this.selectedWorkflowInstanceIds}),this.selectedWorkflowInstanceIds=[],await this.loadWorkflowInstances(),this.currentPage=0}async onBulkRetry(){const e=this.t;if(!await q.show(e("BulkRetryDialog.Title"),e("BulkRetryDialog.Message")))return;const t=await this.createClient();await t.workflowInstancesApi.bulkRetry({workflowInstanceIds:this.selectedWorkflowInstanceIds}),this.selectedWorkflowInstanceIds=[],await this.loadWorkflowInstances(),this.currentPage=0}async onBulkActionSelected(e){const t=e.detail;switch(t.name){case"Cancel":await this.onBulkCancel();break;case"Delete":await this.onBulkDelete();break;case"Retry":await this.onBulkRetry();break;default:t.handler()}this.updateSelectAllChecked()}async onSearch(e){e.preventDefault();const t=new FormData(e.currentTarget).get("searchTerm");this.currentSearchTerm=t.toString(),await this.loadWorkflowInstances()}render(){const e=this.basePath,s=this.workflowInstances.items,a=this.workflowBlueprints,l=this.workflowInstances.totalCount,r=this.t;return t("div",null,t("div",{class:"elsa-relative elsa-z-10 elsa-flex-shrink-0 elsa-flex elsa-h-16 elsa-bg-white elsa-border-b elsa-border-gray-200"},t("div",{class:"elsa-flex-1 elsa-px-4 elsa-flex elsa-justify-between sm:elsa-px-6 lg:elsa-px-8"},t("div",{class:"elsa-flex-1 elsa-flex"},t("form",{class:"elsa-w-full elsa-flex md:ml-0",onSubmit:e=>this.onSearch(e)},t("label",{htmlFor:"search_field",class:"elsa-sr-only"},"Search"),t("div",{class:"elsa-relative elsa-w-full elsa-text-gray-400 focus-within:elsa-text-gray-600"},t("div",{class:"elsa-absolute elsa-inset-y-0 elsa-left-0 elsa-flex elsa-items-center elsa-pointer-events-none"},t("svg",{class:"elsa-h-5 elsa-w-5",fill:"currentColor",viewBox:"0 0 20 20"},t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"}))),t("input",{name:"searchTerm",class:"elsa-block elsa-w-full elsa-h-full elsa-pl-8 elsa-pr-3 elsa-py-2 elsa-rounded-md elsa-text-gray-900 elsa-placeholder-gray-500 focus:elsa-placeholder-gray-400 sm:elsa-text-sm elsa-border-0 focus:elsa-outline-none focus:elsa-ring-0",placeholder:r("Search"),type:"search"})))))),t("div",{class:"elsa-p-8 elsa-flex elsa-content-end elsa-justify-right elsa-bg-white elsa-space-x-4"},t("div",{class:"elsa-flex-shrink-0"},this.renderBulkActions()),t("div",{class:"elsa-flex-1"}," "),this.renderPageSizeFilter(),this.renderWorkflowFilter(),this.renderStatusFilter(),this.renderOrderByFilter()),t("div",{class:"elsa-mt-8 sm:elsa-block"},t("div",{class:"elsa-align-middle elsa-inline-block elsa-min-w-full elsa-border-b elsa-border-gray-200"},t("table",{class:"elsa-min-w-full"},t("thead",null,t("tr",{class:"elsa-border-t elsa-border-gray-200"},t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},t("input",{type:"checkbox",value:"true",checked:this.getSelectAllState(),onChange:e=>this.onSelectAllCheckChange(e),ref:e=>this.selectAllCheckboxEl=e,class:"focus:elsa-ring-blue-500 elsa-h-4 elsa-w-4 elsa-text-blue-600 elsa-border-gray-300 elsa-rounded"})),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Id")),t("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.CorrelationId")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Workflow")),t("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-right elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Version")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.InstanceName")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Status")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Created")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Finished")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.LastExecuted")),t("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},r("Table.Faulted")),t("th",{class:"elsa-pr-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"}))),t("tbody",{class:"elsa-bg-white elsa-divide-y elsa-divide-gray-100"},s.map((s=>{var l;const i=null!==(l=a.find((e=>e.versionId==s.definitionVersionId)))&&void 0!==l?l:{name:"Not Found",displayName:"(Workflow definition not found)"},n=i.displayName||i.name||"(Untitled)",o=this.getStatusColor(s.workflowStatus),c=`${e}/workflow-instances/${s.id}`,u=s.correlationId?s.correlationId:"",h=`${e}/workflow-instances?correlationId=${u}`,d=`${e}/workflow-registry/${s.definitionId}`,f=s.name?s.name:"",g=this.selectedWorkflowInstanceIds.findIndex((e=>e===s.id))>=0,p=te(s.createdAt),x=s.finishedAt?te(s.finishedAt):null,y=s.lastExecutedAt?te(s.lastExecutedAt):null,w=s.faultedAt?te(s.faultedAt):null,v=s.workflowStatus==Q.Faulted,m=[{text:r("Table.ContextMenu.View"),anchorUrl:c,icon:t("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}))},{text:r("Table.ContextMenu.Cancel"),clickHandler:e=>this.onCancelClick(e,s),icon:t("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"}))},v?{text:r("Table.ContextMenu.Retry"),clickHandler:e=>this.onRetryClick(e,s),icon:t("svg",{class:"elsa-h-5 w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("path",{d:"M12 17l-2 2l2 2m-2 -2h9a2 2 0 0 0 1.75 -2.75l-.55 -1"}),t("path",{d:"M12 17l-2 2l2 2m-2 -2h9a2 2 0 0 0 1.75 -2.75l-.55 -1",transform:"rotate(120 12 13)"}),t("path",{d:"M12 17l-2 2l2 2m-2 -2h9a2 2 0 0 0 1.75 -2.75l-.55 -1",transform:"rotate(240 12 13)"}))}:null,{text:r("Table.ContextMenu.Delete"),clickHandler:e=>this.onDeleteClick(e,s),icon:t("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("line",{x1:"4",y1:"7",x2:"20",y2:"7"}),t("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),t("line",{x1:"14",y1:"11",x2:"14",y2:"17"}),t("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),t("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"}))}].filter((e=>null!=e));return t("tr",null,t("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900"},t("input",{type:"checkbox",value:s.id,checked:g,onChange:e=>this.onWorkflowInstanceCheckChange(e,s),class:"focus:elsa-ring-blue-500 elsa-h-4 elsa-w-4 elsa-text-blue-600 elsa-border-gray-300 elsa-rounded"})),t("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900"},t("stencil-route-link",{url:c,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},s.id)),t("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900"},t("stencil-route-link",{url:h,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},u)),t("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900 elsa-text-left"},t("stencil-route-link",{url:d,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},n)),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-right elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-uppercase"},s.version),t("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900 elsa-text-left"},t("stencil-route-link",{url:c,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},f)),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},t("div",{class:"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2"},t("div",{class:`flex-shrink-0 elsa-w-2-5 elsa-h-2-5 elsa-rounded-full elsa-bg-${o}-600`}),t("span",null,s.workflowStatus))),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-left"},p.format("DD-MM-YYYY HH:mm:ss")),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-left"},x?x.format("DD-MM-YYYY HH:mm:ss"):"-"),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-left"},y?y.format("DD-MM-YYYY HH:mm:ss"):"-"),t("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-left"},w?w.format("DD-MM-YYYY HH:mm:ss"):"-"),t("td",{class:"elsa-pr-6"},t("elsa-context-menu",{history:this.history,menuItems:m})))})))),t("elsa-pager",{page:this.currentPage,pageSize:this.currentPageSize,totalCount:l,history:this.history,onPaged:this.onPaged,culture:this.culture}))))}renderBulkActions(){const e=t("svg",{class:"elsa-mr-3 elsa-h-5 elsa-w-5 elsa-text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M13 10V3L4 14h7v7l9-11h-7z"})),s=this.bulkActions;return t("elsa-dropdown-button",{text:(0,this.t)("BulkActions.Title"),items:s,icon:e,origin:ee.TopLeft,onItemSelected:e=>this.onBulkActionSelected(e)})}renderWorkflowFilter(){const e=this.t,s=this.getLatestWorkflowBlueprintVersions(),a=this.selectedCorrelationId,l=this.selectedWorkflowId,r=s.find((e=>e.id==l)),i=l?r&&(r.name||r.displayName)?r.displayName||r.name:e("Untitled"):e("Filters.Workflow.Label"),n=this.selectedWorkflowStatus,o=this.selectedOrderByState,c=this.history;let u=s.map((t=>{const s={text:t.displayName&&t.displayName.length>0?t.displayName:t.name||e("Untitled"),value:t.id,isSelected:t.id==l};return c&&(s.url=this.buildFilterUrl(t.id,n,o,null,a)),s}));const h={text:e("Filters.Workflow.All"),value:null,isSelected:!l};return c&&(h.url=this.buildFilterUrl(null,n,o,null,a)),u=[h,...u],t("elsa-dropdown-button",{text:i,items:u,icon:t("svg",{class:"elsa-mr-3 elsa-h-5 elsa-w-5 elsa-text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("rect",{x:"4",y:"4",width:"6",height:"6",rx:"1"}),t("rect",{x:"14",y:"4",width:"6",height:"6",rx:"1"}),t("rect",{x:"4",y:"14",width:"6",height:"6",rx:"1"}),t("rect",{x:"14",y:"14",width:"6",height:"6",rx:"1"})),origin:ee.TopRight,onItemSelected:e=>this.handleWorkflowIdChanged(e.detail.value)})}renderStatusFilter(){const e=this.t,s=this.correlationId,a=this.selectedWorkflowStatus,l=a||e("Filters.Status.Label"),r=this.history,i=[null,Q.Running,Q.Suspended,Q.Finished,Q.Faulted,Q.Cancelled,Q.Idle].map((t=>{const l={text:null!=t?t:e("Filters.Status.All"),isSelected:t==a,value:t};return r&&(l.url=this.buildFilterUrl(this.selectedWorkflowId,t,this.selectedOrderByState,null,s)),l}));return t("elsa-dropdown-button",{text:l,items:i,icon:t("svg",{class:"elsa-mr-3 elsa-h-5 elsa-w-5 elsa-text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("circle",{cx:"12",cy:"12",r:"10"}),t("polygon",{points:"10 8 16 12 10 16 10 8"})),origin:ee.TopRight,onItemSelected:e=>this.handleWorkflowStatusChanged(e.detail.value)})}renderPageSizeFilter(){const e=this.correlationId,s=this.currentPageSize,a=(0,this.t)("Filters.PageSize.SelectedLabel",{Size:s}),l=this.history,r=[5,10,15,20,30,50,100].map((t=>{const a={text:""+t,isSelected:t==s,value:t};return l&&(a.url=this.buildFilterUrl(this.selectedWorkflowId,this.selectedWorkflowStatus,this.selectedOrderByState,t,e)),a}));return t("elsa-dropdown-button",{text:a,items:r,icon:t("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-400 elsa-mr-2",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("line",{x1:"9",y1:"6",x2:"20",y2:"6"}),t("line",{x1:"9",y1:"12",x2:"20",y2:"12"}),t("line",{x1:"9",y1:"18",x2:"20",y2:"18"}),t("line",{x1:"5",y1:"6",x2:"5",y2:"6.01"}),t("line",{x1:"5",y1:"12",x2:"5",y2:"12.01"}),t("line",{x1:"5",y1:"18",x2:"5",y2:"18.01"})),origin:ee.TopRight,onItemSelected:e=>this.handlePageSizeChanged(e.detail.value)})}renderOrderByFilter(){const e=this.t,s=this.correlationId,a=this.selectedOrderByState,l=a?e("Filters.Sort.SelectedLabel",{Key:a}):e("Filters.Sort.Label"),r=this.history,i=[G.Finished,G.LastExecuted,G.Started].map((e=>{const t={text:e,value:e,isSelected:e==a};return r&&(t.url=this.buildFilterUrl(this.selectedWorkflowId,this.selectedWorkflowStatus,e,null,s)),t}));return t("elsa-dropdown-button",{text:l,items:i,icon:t("svg",{class:"elsa-mr-3 elsa-h-5 elsa-w-5 elsa-text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})),origin:ee.TopRight,onItemSelected:e=>this.handleOrderByChanged(e.detail.value)})}static get watchers(){return{workflowId:["handleWorkflowIdChanged"],correlationId:["handleCorrelationIdChanged"],workflowStatus:["handleWorkflowStatusChanged"],currentPageSize:["handlePageSizeChanged"],orderBy:["handleOrderByChanged"]}}};Xe.DEFAULT_PAGE_SIZE=15,Xe.MIN_PAGE_SIZE=5,Xe.MAX_PAGE_SIZE=100,Xe.START_PAGE=0,ae.injectProps(Xe,["serverUrl","culture","basePath"]),s(Xe);export{Xe as elsa_workflow_instance_list_screen}