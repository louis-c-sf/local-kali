"use client";
import{jsx as e}from"react/jsx-runtime";import{useLayoutEffect as t,useEffect as n,useRef as o,memo as r,useMemo as i,useReducer as s,forwardRef as l,useImperativeHandle as c}from"react";import{flushSync as f}from"react-dom";const d=null,{min:u,max:a,abs:h,floor:p}=Math,v=(e,t,n)=>u(n,a(t,e)),g=e=>[...e].sort(((e,t)=>e-t)),_="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},m=e=>{let t,n;return()=>(t||(t=!0,n=e()),n)},w=-1,$=(e,t,n)=>{const o=n?"unshift":"push";for(let n=0;n<t;n++)e[o](w);return e},S=(e,t)=>{const n=e.t[t];return n===w?e.o:n},y=(e,t,n)=>{const o=e.t[t]===w;return e.t[t]=n,e.i=u(t,e.i),o},x=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let n=e.i,o=e.u[n];for(;n<t;)o+=S(e,n),e.u[++n]=o;return e.i=t,o},b=(e,t,n=0,o=e.l-1)=>{for(;n<=o;){const r=p((n+o)/2),i=x(e,r);if(i<=t){if(i+S(e,r)>t)return r;n=r+1}else o=r-1}return v(n,0,e.l-1)},I=(e,t,n)=>{const o=t-e.l;return e.i=n?-1:u(t-1,e.i),e.l=t,o>0?($(e.u,o),$(e.t,o,n),e.o*o):(e.u.splice(o),(n?e.t.splice(0,-o):e.t.splice(o)).reduce(((t,n)=>t-(n===w?e.o:n)),0))},z="undefined"!=typeof window,k=()=>document.documentElement,T=e=>e.ownerDocument,R=e=>e.defaultView,M=/*#__PURE__*/m((()=>!!z&&"rtl"===getComputedStyle(k()).direction)),C=/*#__PURE__*/m((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),E=/*#__PURE__*/m((()=>"scrollBehavior"in k().style)),H=e=>a(e.h(),e.p()),W=e=>!!e.p(),J=(e,t=40,n=4,o=0,r,i=!1)=>{let s=!!o,l=[],c=0,f=0,p=0,v=0,_=0,m=0,z=0,k=0,T=0,R=s?[0,a(o-1,0)]:d,M=[0,0],E=0;const H=((e,t,n)=>({o:n?n[1]:t,t:n&&n[0]?$(n[0].slice(0,u(e,n[0].length)),a(0,e-n[0].length)):$([],e),l:e,i:-1,u:$([],e)}))(e,t,r),W=new Set,J=()=>p-f,B=()=>J()+m+_,O=e=>((e,t,n,o)=>{if(o=u(o,e.l-1),x(e,o)<=t){const r=b(e,t+n,o);return[b(e,t,o,r),r]}{const r=b(e,t,void 0,o);return[r,b(e,t+n,r)]}})(H,e,c,M[0]),L=()=>(e=>e.l?x(e,e.l-1)+S(e,e.l-1):0)(H),P=e=>x(H,e)-m,A=e=>S(H,e),V=e=>{e&&(C()&&0!==k?m+=e:(_+=e,v++))};return{v:()=>l,_:()=>(e=>[e.t.slice(),e.o])(H),m:()=>{if(z)return M;let[e,t]=O(a(0,B()));return R&&(e=u(e,R[0]),t=a(t,R[1])),1!==k&&(e-=a(0,n)),2!==k&&(t+=a(0,n)),M=[a(e,0),u(t,H.l-1)]},$:()=>b(H,B()),S:()=>b(H,B()+c),I:e=>H.t[e]===w,k:()=>!!R&&H.t.slice(a(0,R[0]-1),u(H.l-1,R[1]+1)+1).includes(w),T:P,R:A,M:()=>H.l,C:()=>p,H:()=>0!==k,p:()=>c,W:()=>f,h:L,J:()=>v,B:()=>(z=_,_=0,[z,2===T||J()+c>=L()]),O:(e,t)=>{const n=[e,t];return W.add(n),()=>{W.delete(n)}},L:(e,t)=>{let n,o,r=0;switch(e){case 1:{const e=z;z=0;const n=t-p,i=h(n);e&&i<h(e)+1||0!==T||(k=n<0?2:1),s&&(R=d,s=!1),p=t,r=4;const l=J();l>=-c&&l<=L()&&(r+=1,o=i>c);break}case 2:r=8,0!==k&&(n=!0,r+=1),k=0,T=0,R=d;break;case 3:{const e=t.filter((([e,t])=>H.t[e]!==t));if(!e.length)break;V(e.reduce(((e,[t,n])=>((2===T||(R?!s&&t<R[0]:P(t)+(0===k&&0===T?A(t):0)<J()))&&(e+=n-A(t)),e)),0));for(const[t,n]of e){const e=A(t),o=y(H,t,n);i&&(E+=o?n:n-e)}i&&c&&E>c&&(V(((e,t)=>{let n=0;const o=[];e.t.forEach(((e,r)=>{e!==w&&(o.push(e),r<t&&n++)})),e.i=-1;const r=g(o),i=r.length,s=i/2|0,l=i%2==0?(r[s-1]+r[s])/2:r[s],c=e.o;return((e.o=l)-c)*a(t-n,0)})(H,b(H,B()))),i=!1),r=3,o=!0;break}case 4:c!==t&&(c=t,r=3);break;case 5:t[1]?(V(I(H,t[0],!0)),T=2,r=1):(I(H,t[0]),r=1);break;case 6:f=t;break;case 7:T=1;break;case 8:R=O(t),r=1}r&&(l=[],n&&m&&(_+=m,m=0,v++),W.forEach((([e,t])=>{r&e&&t(o)})))}}},B=setTimeout,O=(e,t)=>t&&M()?-e:e,L=(e,t,n,o,r,i)=>{const s=Date.now;let l=0,c=!1,f=!1,u=!1,a=!1;const h=(()=>{let t;const n=()=>{t!=d&&clearTimeout(t)},o=()=>{n(),t=B((()=>{t=d,(()=>{if(c||f)return c=!1,void h();u=!1,e.L(2)})()}),150)};return o.P=n,o})(),p=()=>{l=s(),u&&(a=!0),i&&e.L(6,i()),e.L(1,o()),h()},v=t=>{if(c||!e.H()||t.ctrlKey)return;const o=s()-l;150>o&&50<o&&(n?t.deltaX:t.deltaY)&&(c=!0)},g=()=>{f=!0,u=a=!1},_=()=>{f=!1,C()&&(u=!0)};return t.addEventListener("scroll",p),t.addEventListener("wheel",v,{passive:!0}),t.addEventListener("touchstart",g,{passive:!0}),t.addEventListener("touchend",_,{passive:!0}),{A:()=>{t.removeEventListener("scroll",p),t.removeEventListener("wheel",v),t.removeEventListener("touchstart",g),t.removeEventListener("touchend",_),h.P()},V:()=>{const[t,i]=e.B();t&&(r(O(t,n),i,a),a=!1,i&&e.p()>e.h()&&e.L(1,o()))}}},P=(e,t)=>{let n,o,r;const i=t?"scrollLeft":"scrollTop",s=t?"overflowX":"overflowY",l=async(o,s)=>{if(!n)return void _((()=>l(o,s)));r&&r();const c=()=>{let t;return[new Promise(((n,o)=>{t=n,r=o,W(e)&&B(o,150)})),e.O(2,(()=>{t&&t()}))]};if(s&&E()){for(;e.L(8,o()),e.k();){const[e,t]=c();try{await e}catch(e){return}finally{t()}}n.scrollTo({[t?"left":"top"]:O(o(),t),behavior:"smooth"})}else for(;;){const[r,s]=c();try{n[i]=O(o(),t),e.L(7),await r}catch(e){return}finally{s()}}};return{X(l){n=l,o=L(e,l,t,(()=>O(l[i],t)),((t,n,o)=>{if(o){const e=l.style,t=e[s];e[s]="hidden",B((()=>{e[s]=t}))}n?(l[i]=e.C()+t,r&&r()):l[i]+=t}))},Y(){o&&o.A()},j(e){l((()=>e))},q(t){t+=e.C(),l((()=>t))},D(t,{align:n,smooth:o,offset:r=0}={}){if(t=v(t,0,e.M()-1),"nearest"===n){const o=e.T(t),r=e.C();if(o<r)n="start";else{if(!(o+e.R(t)>r+e.p()))return;n="end"}}l((()=>r+e.W()+e.T(t)+("end"===n?e.R(t)-e.p():"center"===n?(e.R(t)-e.p())/2:0)),o)},U:()=>{o&&o.V()}}},A=(e,t)=>{let n,o,r;const i=(e,t,n,o,r=0)=>{const s=o?"offsetLeft":"offsetTop",l=r+(o&&M()?n.innerWidth-e[s]-e.offsetWidth:e[s]),c=e.offsetParent;return e!==t&&c?i(c,t,n,o,l):l},s=async(o,i)=>{if(!n)return void _((()=>s(o,i)));r&&r();const l=()=>{let t;return[new Promise(((n,o)=>{t=n,r=o,W(e)&&B(o,150)})),e.O(2,(()=>{t&&t()}))]},c=R(T(n));if(i&&E()){for(;e.L(8,o()),e.k();){const[e,t]=l();try{await e}catch(e){return}finally{t()}}c.scroll({[t?"left":"top"]:O(o(),t),behavior:"smooth"})}else for(;;){const[n,r]=l();try{c.scroll({[t?"left":"top"]:O(o(),t)}),e.L(7),await n}catch(e){return}finally{r()}}};return{X(r){n=r;const s=t?"scrollX":"scrollY",l=T(r),c=R(l),f=l.body;o=L(e,c,t,(()=>O(c[s],t)),((n,o)=>{o?c.scroll({[t?"left":"top"]:e.C()+n}):c.scrollBy(t?n:0,t?0:n)}),(()=>i(r,f,c,t)))},Y(){o&&o.A(),n=void 0},U:()=>{o&&o.V()},D(o,{align:r,smooth:l,offset:c=0}={}){if(!n)return;if(o=v(o,0,e.M()-1),"nearest"===r){const t=e.T(o),n=e.C();if(t<n)r="start";else{if(!(t+e.R(o)>n+e.p()))return;r="end"}}const f=T(n),d=R(f),u=f.documentElement,a=()=>e.p()-(t?u.clientWidth:u.clientHeight);s((()=>c+i(n,f.body,d,t)+e.T(o)+("end"===r?e.R(o)-(e.p()-a()):"center"===r?(e.R(o)-(e.p()-a()))/2:0)),l)}}},V=(e,t)=>{const n=P(e,!1),o=P(t,!0);return{X(e){n.X(e),o.X(e)},Y(){n.Y(),o.Y()},j(e,t){n.j(t),o.j(e)},q(e,t){n.q(t),o.q(e)},D(e,t){n.D(t),o.D(e)},U(){n.U(),o.U()}}},X=e=>{let t;return{F(n){(t||(t=new(R(T(n)).ResizeObserver)(e))).observe(n)},G(e){t.unobserve(e)},A(){t&&t.disconnect()}}},Y=(e,t)=>{let n;const o=t?"width":"height",r=new WeakMap,i=X((t=>{const i=[];for(const{target:s,contentRect:l}of t)if(s.offsetParent)if(s===n)e.L(4,l[o]);else{const e=r.get(s);e!=d&&i.push([e,l[o]])}i.length&&e.L(3,i)}));return{K(e){i.F(n=e)},N:(e,t)=>(r.set(e,t),i.F(e),()=>{r.delete(e),i.G(e)}),Y:i.A}},j=(e,t)=>{const n=t?"width":"height",o=t?"innerWidth":"innerHeight",r=new WeakMap,i=X((t=>{const o=[];for(const{target:e,contentRect:i}of t){if(!e.offsetParent)continue;const t=r.get(e);t!=d&&o.push([t,i[n]])}o.length&&e.L(3,o)}));let s;return{K(t){const n=R(T(t)),r=()=>{e.L(4,n[o])};n.addEventListener("resize",r),r(),s=()=>{n.removeEventListener("resize",r)}},N:(e,t)=>(r.set(e,t),i.F(e),()=>{r.delete(e),i.G(e)}),Y(){s&&s(),i.A()}}},q=(e,t)=>{let n;const o="height",r="width",i=new WeakMap,s=new Set,l=new Set,c=new Map,f=(e,t)=>`${e}-${t}`,d=X((d=>{const u=new Set,h=new Set;for(const{target:s,contentRect:l}of d)if(s.offsetParent)if(s===n)e.L(4,l[o]),t.L(4,l[r]);else{const e=i.get(s);if(e){const[t,n]=e,i=f(t,n),s=c.get(i),d=[l[o],l[r]];let a,p;s?(s[0]!==d[0]&&(a=!0),s[1]!==d[1]&&(p=!0)):a=p=!0,a&&u.add(t),p&&h.add(n),(a||p)&&c.set(i,d)}}if(u.size){const t=[];u.forEach((e=>{let n=0;l.forEach((t=>{const o=c.get(f(e,t));o&&(n=a(n,o[0]))})),n&&t.push([e,n])})),e.L(3,t)}if(h.size){const e=[];h.forEach((t=>{let n=0;s.forEach((e=>{const o=c.get(f(e,t));o&&(n=a(n,o[1]))})),n&&e.push([t,n])})),t.L(3,e)}}));return{K(e){d.F(n=e)},N:(e,t,n)=>(i.set(e,[t,n]),s.add(t),l.add(n),d.F(e),()=>{i.delete(e),d.G(e)}),Y:d.A}},D=z?t:n,U="current",F=(e,t)=>{if(Array.isArray(e))for(const n of e)F(n,t);else null==e||"boolean"==typeof e||t.push(e)},G=(e,t)=>{const n=e.key;return null!=n?n:"_"+t},K=e=>{const t=o();return t[U]||(t[U]=e())},N=e=>{const t=o(e);return D((()=>{t[U]=e}),[e]),t},Q=/*#__PURE__*/r((({Z:t,ee:n,te:r,ne:s,oe:l,re:c,ie:f,se:d})=>{const u=o(null);D((()=>n(u[U],r)),[r]);const a=i((()=>{const e={position:l&&d?void 0:"absolute",[f?"height":"width"]:"100%",[f?"top":"left"]:0,[f?M()?"right":"left":"top"]:s,visibility:!l||d?"visible":"hidden"};return f&&(e.display="flex"),e}),[s,l,d,f]);return e(c,"string"==typeof c?{ref:u,style:a,children:t}:{ref:u,style:a,index:r,children:t})})),Z=e=>s(e.v,void 0,e.v)[1],ee=(e,t)=>i((()=>{if("function"==typeof e)return[e,t||0];const n=(e=>{const t=[];return F(e,t),t})(e);return[e=>n[e],n.length]}),[e,t]),te=/*#__PURE__*/l((({children:t,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,keepMounted:d,cache:u,startMargin:a=0,ssrCount:h,as:p="div",item:v="div",scrollRef:m,onScroll:w,onScrollEnd:$},S)=>{const[y,x]=ee(t,n),b=o(null),I=o(!!h),z=N(w),k=N($),[T,R,M,C]=K((()=>{const e=!!l,t=J(x,i,r,h,u,!i);return[t,Y(t,e),P(t,e),e]}));x!==T.M()&&T.L(5,[x,s]),a!==T.W()&&T.L(6,a);const E=Z(T),[W,B]=T.m(),O=T.H(),L=T.J(),A=T.h(),V=[],X=t=>{const n=y(t);return e(Q,{ee:R.N,te:t,ne:T.T(t),oe:T.I(t),re:v,Z:n,ie:C,se:I[U]},G(n,t))};D((()=>{I[U]=!1;const e=T.O(1,(e=>{e?f(E):E()})),t=T.O(4,(()=>{z[U]&&z[U](T.C())})),n=T.O(8,(()=>{k[U]&&k[U]()})),o=e=>{R.K(e),M.X(e)};return m?_((()=>o(m[U]))):o(b[U].parentElement),()=>{e(),t(),n(),R.Y(),M.Y()}}),[]),D((()=>{M.U()}),[L]),c(S,(()=>({get cache(){return T._()},get scrollOffset(){return T.C()},get scrollSize(){return H(T)},get viewportSize(){return T.p()},findStartIndex:T.$,findEndIndex:T.S,getItemOffset:T.T,getItemSize:T.R,scrollToIndex:M.D,scrollTo:M.j,scrollBy:M.q})),[]);for(let e=W,t=B;e<=t;e++)V.push(X(e));if(d){const e=[],t=[];g(d).forEach((n=>{n<W&&e.push(X(n)),n>B&&t.push(X(n))})),V.unshift(...e),V.push(...t)}return e(p,{ref:b,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:C?A:"100%",height:C?"100%":A,pointerEvents:O?"none":void 0},children:V})})),ne=/*#__PURE__*/l((({children:t,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,keepMounted:c,reverse:f,cache:d,ssrCount:u,item:a,onScroll:h,onScrollEnd:p,style:v,...g},_)=>{const m=o(null),w=f&&!l;let $=e(te,{ref:_,scrollRef:w?m:void 0,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,keepMounted:c,cache:d,ssrCount:u,item:a,onScroll:h,onScrollEnd:p,children:t});return w&&($=e("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:$})),e("div",{ref:m,...g,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...v},children:$})})),oe=/*#__PURE__*/l((({children:t,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,cache:d,ssrCount:u,as:a="div",item:h="div",onScroll:p,onScrollEnd:v},g)=>{const[_,m]=ee(t,n),w=o(null),$=N(p),S=N(v),y=o(!!u),[x,b,I,z]=K((()=>{const e=!!l,t=J(m,i,r,u,d,!i);return[t,j(t,e),A(t,e),e]}));m!==x.M()&&x.L(5,[m,s]);const k=Z(x),[T,R]=x.m(),M=x.H(),C=x.J(),E=x.h(),H=[];D((()=>{y[U]=!1;const e=x.O(1,(e=>{e?f(k):k()})),t=x.O(4,(()=>{$[U]&&$[U]()})),n=x.O(8,(()=>{S[U]&&S[U]()})),o=w[U];return b.K(o),I.X(o),()=>{e(),t(),n(),b.Y(),I.Y()}}),[]),D((()=>{I.U()}),[C]),c(g,(()=>({get cache(){return x._()},findStartIndex:x.$,findEndIndex:x.S,scrollToIndex:I.D})),[]);for(let t=T,n=R;t<=n;t++){const n=_(t);H.push(e(Q,{ee:b.N,te:t,ne:x.T(t),oe:x.I(t),re:h,Z:n,ie:z,se:y[U]},G(n,t)))}return e(a,{ref:w,style:{flex:"none",position:"relative",visibility:"hidden",width:z?E:"100%",height:z?"100%":E,pointerEvents:M?"none":void 0},children:H})})),re=(e,t)=>`${e}-${t}`,ie=/*#__PURE__*/r((({Z:t,ee:n,le:r,ce:s,fe:l,de:c,ue:f,ae:d,oe:u,he:a})=>{const h=o(null);return D((()=>n.N(h[U],r,s)),[s,r]),e(a,{ref:h,style:i((()=>({display:"grid",position:"absolute",top:l,[M()?"right":"left"]:c,visibility:u?"hidden":"visible",minHeight:f,minWidth:d})),[l,c,d,f,u]),children:t})})),se=/*#__PURE__*/l((({children:t,row:n,col:r,cellHeight:s=40,cellWidth:l=100,overscan:d=2,initialRowCount:u,initialColCount:a,item:h="div",style:p,...v},g)=>{const[_,m,w,$]=K((()=>{const e=J(n,s,d,u),t=J(r,l,d,a);return[e,t,q(e,t),V(e,t)]}));n!==_.M()&&_.L(5,[n]),r!==m.M()&&m.L(5,[r]);const S=Z(_),y=Z(m),[x,b]=_.m(),[I,z]=m.m(),k=_.H(),T=m.H(),R=_.J(),M=m.J(),C=H(_),E=H(m),W=o(null);D((()=>{const e=W[U],t=_.O(1,(e=>{e?f(S):S()})),n=m.O(1,(e=>{e?f(y):y()}));return w.K(e),$.X(e),()=>{t(),n(),w.Y(),$.Y()}}),[]),D((()=>{$.U()}),[R,M]),c(g,(()=>({get scrollTop(){return _.C()},get scrollLeft(){return m.C()},get scrollHeight(){return H(_)},get scrollWidth(){return H(m)},get viewportHeight(){return _.p()},get viewportWidth(){return m.p()},scrollToIndex:$.D,scrollTo:$.j,scrollBy:$.q})),[]);const B=i((()=>{const e=new Map;return(n,o)=>{let r=e.get(re(n,o));return r||e.set(re(n,o),r=t({rowIndex:n,colIndex:o})),r}}),[t]),O=[];for(let t=x;t<=b;t++)for(let n=I;n<=z;n++)O.push(e(ie,{ee:w,le:t,ce:n,fe:_.T(t),de:m.T(n),ue:_.R(t),ae:m.R(n),oe:_.I(t)||m.I(n),he:h,Z:B(t,n)},re(t,n)));return e("div",{ref:W,...v,style:{overflow:"auto",contain:"strict",width:"100%",height:"100%",...p},children:e("div",{style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:E,height:C,pointerEvents:k||T?"none":void 0},children:O})})}));export{ne as VList,te as Virtualizer,oe as WindowVirtualizer,se as experimental_VGrid};
//# sourceMappingURL=index.mjs.map
